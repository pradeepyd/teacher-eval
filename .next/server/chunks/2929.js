"use strict";exports.id=2929,exports.ids=[2929],exports.modules={16189:(a,b,c)=>{var d=c(65773);c.o(d,"useParams")&&c.d(b,{useParams:function(){return d.useParams}}),c.o(d,"useRouter")&&c.d(b,{useRouter:function(){return d.useRouter}})},20092:(a,b,c)=>{c.d(b,{A:()=>l});var d=c(60687),e=c(82136),f=c(85814),g=c.n(f),h=c(16189),i=c(47033),j=c(95758);function k({children:a,title:b,showBack:c=!0,showTitle:f=!0}){let{data:j}=(0,e.useSession)(),k=(0,h.useRouter)();return(0,d.jsxs)("div",{className:"min-h-screen bg-gray-50 pt-16",children:[(0,d.jsx)("nav",{className:"bg-white shadow-sm border-b fixed inset-x-0 top-0 z-50",children:(0,d.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,d.jsxs)("div",{className:"flex justify-between h-16",children:[(0,d.jsx)("div",{className:"flex items-center",children:(0,d.jsx)(g(),{href:"/dashboard",className:"text-xl font-semibold text-gray-900",children:"MCQ Teacher Evaluation"})}),(0,d.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,d.jsxs)("div",{className:"text-sm text-gray-700",children:[(0,d.jsx)("span",{className:"font-medium",children:j?.user?.name}),(0,d.jsxs)("span",{className:"ml-2 text-gray-500",children:["(",j?.user?.role,")"]}),(0,d.jsx)("span",{className:"ml-2 text-gray-500",children:j?.user?.departmentName})]}),(0,d.jsx)("button",{onClick:()=>{(0,e.signOut)({callbackUrl:"/login"})},className:"bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded text-sm",children:"Logout"})]})]})})}),(0,d.jsx)("div",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:(0,d.jsxs)("div",{className:"px-4 py-6 sm:px-0",children:[c&&(0,d.jsx)("div",{className:"mb-2",children:(0,d.jsxs)("button",{"aria-label":"Back",onClick:()=>{window.history.length>1?k.back():k.push("/admin")},className:"inline-flex items-center justify-center rounded-md border border-gray-200 bg-white px-2 py-1 text-sm text-gray-700 hover:bg-gray-50",children:[(0,d.jsx)(i.A,{className:"h-4 w-4"}),(0,d.jsx)("span",{className:"ml-1 hidden sm:inline",children:"Back"})]})}),f&&b?(0,d.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:b}):null,a]})})]})}function l(a){return(0,d.jsx)(j.PageErrorBoundary,{pageName:"Dashboard Layout",children:(0,d.jsx)(k,{...a})})}},34729:(a,b,c)=>{c.d(b,{T:()=>f});var d=c(60687);c(43210);var e=c(4780);function f({className:a,...b}){return(0,d.jsx)("textarea",{"data-slot":"textarea",className:(0,e.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),...b})}},47033:(a,b,c)=>{c.d(b,{A:()=>d});let d=(0,c(62688).A)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},64981:(a,b,c)=>{c.d(b,{A:()=>i});var d=c(60687),e=c(82136),f=c(16189);c(43210);var g=c(95758);function h({allowedRoles:a,children:b,fallback:c=(0,d.jsx)("div",{children:"Access denied. You don't have permission to view this page."})}){let{data:g,status:h}=(0,e.useSession)();if((0,f.useRouter)(),"loading"===h)return(0,d.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,d.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});let i=g?.user?.role;return g&&i&&a.includes(i)?(0,d.jsx)(d.Fragment,{children:b}):(0,d.jsx)(d.Fragment,{children:c})}function i(a){return(0,d.jsx)(g.PageErrorBoundary,{pageName:"Role Guard",children:(0,d.jsx)(h,{...a})})}},82832:(a,b,c)=>{c.d(b,{A:()=>m});var d=c(60687),e=c(43210),f=c(29523),g=c(89667),h=c(34729),i=c(96834),j=c(52581),k=c(82136);let l={teacherData:null,isLoading:!1,hasData:!1};function m({teacherId:a,term:b,reviewerRole:c,onSubmit:m,onCancel:n,loading:o=!1}){let{fetchTeacherData:p,submitReview:q}=function(){let{status:a}=(0,k.useSession)(),[b,c]=(0,e.useState)(!1),[d,f]=(0,e.useState)(null),g=(0,e.useCallback)(async(a,b,d)=>{let e=`${a}-${b}-${d}`;if(l.teacherData&&l.teacherData[e])return l.teacherData[e];c(!0),f(null);try{let c=await fetch(`${"HOD"===d?"/api/reviews/hod/teacher-data":"/api/reviews/asst-dean/teacher-data"}?teacherId=${a}&term=${b}`);if(!c.ok){let a=await c.json();throw Error(a.error||"Failed to fetch teacher data")}let f=await c.json();return l.teacherData||(l.teacherData={}),l.teacherData[e]=f,l.hasData=!0,f}catch(a){throw f(a instanceof Error?a.message:"Error fetching teacher data"),a}finally{c(!1)}},[]),h=(0,e.useCallback)(()=>{l.hasData=!1,l.teacherData=null},[]),i=(0,e.useCallback)(async(a,b)=>{try{let c=await fetch("HOD"===b?"/api/reviews/hod":"/api/reviews/asst-dean",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!c.ok){let a=await c.json();throw Error(a.error||"Failed to submit review")}return h(),c.json()}catch(a){throw a}},[h]);return{teacherData:null,loading:b||l.isLoading,error:d,fetchTeacherData:g,submitReview:i}}(),[r,s]=(0,e.useState)(null),[t,u]=(0,e.useState)(""),[v,w]=(0,e.useState)({}),[x,y]=(0,e.useState)({}),[z,A]=(0,e.useState)(0),[B,C]=(0,e.useState)(!0),[D,E]=(0,e.useState)(""),F=(d=!1)=>{if(!r?.canEdit&&!d)return;if((r?.answers.filter(a=>void 0===v[a.question.id]||v[a.question.id]<0)||[]).length>0)return void E("Please provide scores for all questions");if(!t.trim())return void E("Comments are required");let e=Object.keys(x).filter(a=>a.startsWith("[Professionalism]")),f=Object.keys(x).filter(a=>a.startsWith("[Responsibilities]")),g=Object.keys(x).filter(a=>a.startsWith("[Development]")),h=a=>a.reduce((a,b)=>a+(x[b]||0),0),i=2*h(e),k=h(f),l=h(g),n={comments:t.trim(),scores:{questionScores:v,rubric:x,professionalismSubtotal:i,responsibilitiesSubtotal:k,developmentSubtotal:l,totalScore:i+k+l},overallRating:z,submitted:d};q({teacherId:a,comment:n.comments,score:n.overallRating,term:b},c).then(()=>{m(n)}).catch(a=>{E(a instanceof Error?a.message:"Failed to submit review"),j.oR.error("Failed to submit review")})};if(B)return(0,d.jsx)("div",{className:"flex items-center justify-center min-h-64",children:(0,d.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});if(D&&!r)return(0,d.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:D});if(!r)return(0,d.jsx)("div",{className:"text-center py-8",children:(0,d.jsx)("p",{className:"text-gray-500",children:"No data available"})});let G=r.existingReview?.submitted||!1;return(0,d.jsx)("div",{className:"max-w-6xl mx-auto",children:(0,d.jsxs)("div",{className:"bg-white shadow rounded-lg",children:[(0,d.jsx)("div",{className:"px-6 py-4 border-b border-gray-200 bg-gradient-to-r from-indigo-50 to-blue-50",children:(0,d.jsxs)("div",{className:"flex justify-between items-start",children:[(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,d.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"HOD"===c?"HOD Review":"Assistant Dean Review"}),(0,d.jsx)("span",{className:`inline-flex px-3 py-1 text-sm font-semibold rounded-full ${"START"===b?"bg-emerald-100 text-emerald-800":"bg-amber-100 text-amber-800"}`,children:"START"===b?"START Term":"END Term"})]}),(0,d.jsxs)("p",{className:"text-sm text-gray-600",children:[r.teacher.name," - ",r.teacher.department]})]}),G&&(0,d.jsx)(i.E,{className:"bg-green-100 text-green-800",children:"Submitted"})]})}),(0,d.jsxs)("div",{className:"p-6",children:[D&&(0,d.jsx)("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:D}),(0,d.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Teacher's Responses"}),(0,d.jsx)("div",{className:"space-y-6",children:r.answers.map((a,b)=>(0,d.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,d.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,d.jsxs)("h4",{className:"text-sm font-medium text-gray-900",children:["Question ",b+1]}),(0,d.jsx)("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded",children:a.question.type})]}),(0,d.jsx)("p",{className:"text-gray-700 mb-3",children:a.question.question}),(0,d.jsxs)("div",{className:"bg-blue-50 rounded p-3",children:[(0,d.jsx)("p",{className:"text-sm text-blue-900 font-medium mb-1",children:"Teacher's Answer:"}),(0,d.jsx)("div",{className:"text-blue-800",children:(()=>{try{let b="string"==typeof a.answer?JSON.parse(a.answer):null;if(b&&b.details&&"object"==typeof b.details){let a=Object.entries(b.details).filter(([,a])=>(a||"").trim().length>0);if(a.length>0)return(0,d.jsx)("div",{className:"space-y-1",children:a.map(([a,b])=>(0,d.jsxs)("div",{children:[(0,d.jsxs)("span",{className:"font-semibold",children:[a,":"]})," ",b]},a))})}}catch{}return(0,d.jsx)("span",{children:String(a.answer)})})()})]}),(0,d.jsxs)("div",{className:"mt-4",children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Score (0-10 points)"}),(0,d.jsx)(g.p,{type:"number",min:"0",max:"10",value:v[a.question.id]||0,onChange:b=>{var c,d;return c=a.question.id,d=parseInt(b.target.value)||0,void(r?.canEdit&&w(a=>({...a,[c]:d})))},className:"w-20",disabled:!r.canEdit})]})]},a.id))}),(0,d.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,d.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Teacher's Self-Assessment Comment"}),(0,d.jsx)("div",{className:"bg-blue-50 rounded p-3",children:(0,d.jsx)("p",{className:"text-blue-800",children:r.answers.find(a=>"TEXTAREA"===a.question.type&&a.question.question.includes("comment"))?.answer||"No self-comment provided"})})]})]}),(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsxs)("div",{className:"flex justify-between items-center",children:[(0,d.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Your Review"}),(0,d.jsxs)("div",{className:"text-sm text-gray-600",children:["Total Score: ",(0,d.jsxs)("span",{className:"font-semibold",children:[(()=>{let a=Object.keys(x).filter(a=>a.startsWith("[Professionalism]")),b=Object.keys(x).filter(a=>a.startsWith("[Responsibilities]")),c=Object.keys(x).filter(a=>a.startsWith("[Development]"));if(a.length+b.length+c.length>0){let d=a=>a.reduce((a,b)=>a+(x[b]||0),0);return 2*d(a)+d(b)+d(c)}return Object.values(v).reduce((a,b)=>a+b,0)})(),"/",10*(r?.answers.length||0)]})]})]}),(0,d.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,d.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Rubric (1–5 per item)"}),(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"text-sm font-semibold text-gray-800 mb-2",children:"Professionalism (x2)"}),["Compliance","Punctuality/Attendance","Ability to deal with students","Competence and Performance"].map(a=>{let b=`[Professionalism] ${a}`;return(0,d.jsxs)("div",{className:"flex items-center justify-between py-1",children:[(0,d.jsx)("span",{className:"text-sm text-gray-700",children:a}),(0,d.jsx)("div",{className:"flex items-center gap-2",children:[1,2,3,4,5].map(a=>(0,d.jsx)("button",{type:"button",onClick:()=>r?.canEdit&&y(c=>({...c,[b]:a})),className:`w-8 h-8 rounded-md text-sm border ${x[b]===a?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300"}`,disabled:!r?.canEdit,children:a},a))})]},b)})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"text-sm font-semibold text-gray-800 mb-2",children:"College Responsibilities"}),["Attending Non-Teaching Activities","Department Related Duties","Collegial Relationship","Ability to Deal with Supervisors","Participation in College Committees"].map(a=>{let b=`[Responsibilities] ${a}`;return(0,d.jsxs)("div",{className:"flex items-center justify-between py-1",children:[(0,d.jsx)("span",{className:"text-sm text-gray-700",children:a}),(0,d.jsx)("div",{className:"flex items-center gap-2",children:[1,2,3,4,5].map(a=>(0,d.jsx)("button",{type:"button",onClick:()=>r?.canEdit&&y(c=>({...c,[b]:a})),className:`w-8 h-8 rounded-md text-sm border ${x[b]===a?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300"}`,disabled:!r?.canEdit,children:a},a))})]},b)})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"text-sm font-semibold text-gray-800 mb-2",children:"Professional Development"}),["In-Service Training","Research and Publications","National and International Conferences"].map(a=>{let b=`[Development] ${a}`;return(0,d.jsxs)("div",{className:"flex items-center justify-between py-1",children:[(0,d.jsx)("span",{className:"text-sm text-gray-700",children:a}),(0,d.jsx)("div",{className:"flex items-center gap-2",children:[1,2,3,4,5].map(a=>(0,d.jsx)("button",{type:"button",onClick:()=>r?.canEdit&&y(c=>({...c,[b]:a})),className:`w-8 h-8 rounded-md text-sm border ${x[b]===a?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300"}`,disabled:!r?.canEdit,children:a},a))})]},b)})]})]})]}),(0,d.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,d.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Overall Performance Rating"}),(0,d.jsxs)("div",{className:"flex items-center gap-4",children:[(0,d.jsx)("label",{htmlFor:"overallRating",className:"block text-sm font-medium text-gray-700",children:"Overall Rating (1-10 points):"}),(0,d.jsx)(g.p,{id:"overallRating",type:"number",min:"1",max:"10",value:z,onChange:a=>A(parseInt(a.target.value)||0),className:"w-20",disabled:!r.canEdit}),(0,d.jsx)("span",{className:"text-sm text-gray-500",children:"/ 10"})]}),(0,d.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"Rate the teacher's overall performance based on their answers and rubric scores"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{htmlFor:"comments",className:"block text-sm font-medium text-gray-700 mb-2",children:"Review Comments"}),(0,d.jsx)(h.T,{id:"comments",value:t,onChange:a=>u(a.target.value),rows:8,placeholder:`Provide your ${"HOD"===c?"HOD":"Assistant Dean"} review comments...`,disabled:!r.canEdit,required:!0})]}),r.canEdit&&(0,d.jsxs)("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[(0,d.jsx)(f.$,{variant:"outline",onClick:n,disabled:o,children:"Cancel"}),(0,d.jsx)(f.$,{variant:"outline",onClick:()=>F(!1),disabled:o,children:o?"Saving...":"Save Draft"}),(0,d.jsx)(f.$,{onClick:()=>F(!0),disabled:o,children:o?"Submitting...":"Submit Review"})]}),G&&(0,d.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-md p-4",children:(0,d.jsxs)("div",{className:"flex",children:[(0,d.jsx)("div",{className:"flex-shrink-0",children:(0,d.jsx)("span",{className:"text-green-400 text-xl",children:"✓"})}),(0,d.jsxs)("div",{className:"ml-3",children:[(0,d.jsx)("h3",{className:"text-sm font-medium text-green-800",children:"Review Submitted"}),(0,d.jsx)("p",{className:"text-sm text-green-700 mt-1",children:"Your review has been successfully submitted and is now part of the evaluation process."})]})]})})]})]})]})]})})}},89667:(a,b,c)=>{c.d(b,{p:()=>g});var d=c(60687),e=c(43210),f=c(4780);let g=e.forwardRef(function({className:a,type:b,...c},e){return(0,d.jsx)("input",{ref:e,type:b,"data-slot":"input",className:(0,f.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",a),...c})});g.displayName="Input"},96834:(a,b,c)=>{c.d(b,{E:()=>i});var d=c(60687);c(43210);var e=c(8730),f=c(24224),g=c(4780);let h=(0,f.F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function i({className:a,variant:b,asChild:c=!1,...f}){let i=c?e.DX:"span";return(0,d.jsx)(i,{"data-slot":"badge",className:(0,g.cn)(h({variant:b}),a),...f})}}};