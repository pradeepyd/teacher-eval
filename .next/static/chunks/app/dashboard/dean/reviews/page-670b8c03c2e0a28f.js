(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2376],{23458:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>x});var l=s(95155),r=s(12115),a=s(12108),d=s(79783),i=s(12638),n=s(6874),c=s.n(n);function x(){let{data:e}=(0,a.useSession)(),[t,s]=(0,r.useState)([]),[n,x]=(0,r.useState)(!0),[m,h]=(0,r.useState)(""),[o,u]=(0,r.useState)("ALL");(0,r.useEffect)(()=>{let t=async()=>{try{let e="ALL"!==o?"?term=".concat(o):"",t=await fetch("/api/reviews/dean".concat(e));if(t.ok){let e=await t.json();s(e)}else h("Failed to fetch teachers for final review")}catch(e){h("Error fetching teachers")}finally{x(!1)}};e&&t()},[e,o]);let N=(e,t)=>{let s=e.receivedHodReviews.find(e=>e.term===t),l=e.receivedAsstReviews.find(e=>e.term===t),r=e.receivedFinalReviews.find(e=>e.term===t);return s&&s.submitted?l&&l.submitted?r?r.submitted?{status:"COMPLETED",text:r.status,color:"PROMOTED"===r.status?"green":"ON_HOLD"===r.status?"yellow":"red"}:{status:"DRAFT",text:"Draft Saved",color:"blue"}:{status:"PENDING",text:"Pending Final Review",color:"yellow"}:{status:"ASST_PENDING",text:"Asst Dean Review Pending",color:"gray"}:{status:"HOD_PENDING",text:"HOD Review Pending",color:"gray"}},f=t.filter(e=>{if("ALL"===o)return!0;let t=e.receivedHodReviews.find(e=>e.term===o),s=e.receivedAsstReviews.find(e=>e.term===o);return t&&t.submitted&&s&&s.submitted});return n?(0,l.jsx)(d.A,{allowedRoles:["DEAN"],children:(0,l.jsx)(i.A,{title:"Final Reviews",children:(0,l.jsx)("div",{className:"flex items-center justify-center min-h-64",children:(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})})}):(0,l.jsx)(d.A,{allowedRoles:["DEAN"],children:(0,l.jsx)(i.A,{title:"Dean Final Reviews",children:(0,l.jsxs)("div",{className:"space-y-6",children:[m&&(0,l.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:m}),(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)("div",{className:"flex space-x-4",children:(0,l.jsxs)("select",{value:o,onChange:e=>u(e.target.value),className:"rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",children:[(0,l.jsx)("option",{value:"ALL",children:"All Terms"}),(0,l.jsx)("option",{value:"START",children:"Start of Year"}),(0,l.jsx)("option",{value:"END",children:"End of Year"})]})}),(0,l.jsxs)("div",{className:"text-sm text-gray-600",children:[f.length," teacher(s) for final review"]})]}),(0,l.jsx)("div",{className:"bg-white shadow rounded-lg",children:(0,l.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,l.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:"Teachers Ready for Final Decision"}),f.length>0?(0,l.jsx)("div",{className:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg",children:(0,l.jsxs)("table",{className:"min-w-full divide-y divide-gray-300",children:[(0,l.jsx)("thead",{className:"bg-gray-50",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Teacher"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Department"}),"ALL"===o?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wide",children:"START Term"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wide",children:"END Term"})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Status"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Final Score"})]}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Actions"})]})}),(0,l.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:f.map(e=>(0,l.jsxs)("tr",{children:[(0,l.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,l.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,l.jsx)("div",{className:"text-sm text-gray-500",children:e.email})]}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,l.jsx)("div",{className:"text-sm text-gray-500",children:e.department.name})}),"ALL"===o?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(()=>{let t=N(e,"START");return(0,l.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat("green"===t.color?"bg-green-100 text-green-800":"yellow"===t.color?"bg-yellow-100 text-yellow-800":"red"===t.color?"bg-red-100 text-red-800":"blue"===t.color?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:t.text})})()}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(()=>{let t=N(e,"END");return(0,l.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat("green"===t.color?"bg-green-100 text-green-800":"yellow"===t.color?"bg-yellow-100 text-yellow-800":"red"===t.color?"bg-red-100 text-red-800":"blue"===t.color?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:t.text})})()})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(()=>{let t=N(e,o);return(0,l.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat("green"===t.color?"bg-green-100 text-green-800":"yellow"===t.color?"bg-yellow-100 text-yellow-800":"red"===t.color?"bg-red-100 text-red-800":"blue"===t.color?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:t.text})})()}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,l.jsx)("div",{className:"text-sm text-gray-900",children:(()=>{let t=e.receivedFinalReviews.find(e=>e.term===o);return t?t.finalScore:"-"})()})})]}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,l.jsx)("div",{className:"flex space-x-2",children:"ALL"!==o?(0,l.jsx)(l.Fragment,{children:"HOD_PENDING"!==N(e,o).status&&"ASST_PENDING"!==N(e,o).status&&(0,l.jsx)(c(),{href:"/dashboard/dean/reviews/".concat(e.id,"/").concat(o),className:"text-red-600 hover:text-red-500 font-medium",children:"PENDING"===N(e,o).status?"Finalize":"View"})}):(0,l.jsxs)(l.Fragment,{children:["HOD_PENDING"!==N(e,"START").status&&"ASST_PENDING"!==N(e,"START").status&&(0,l.jsx)(c(),{href:"/dashboard/dean/reviews/".concat(e.id,"/START"),className:"text-blue-600 hover:text-blue-500 font-medium text-xs",children:"START"}),"HOD_PENDING"!==N(e,"END").status&&"ASST_PENDING"!==N(e,"END").status&&(0,l.jsx)(c(),{href:"/dashboard/dean/reviews/".concat(e.id,"/END"),className:"text-green-600 hover:text-green-500 font-medium text-xs",children:"END"})]})})})]},e.id))})]})}):(0,l.jsxs)("div",{className:"text-center py-8",children:[(0,l.jsx)("div",{className:"text-gray-400 text-4xl mb-4",children:"\uD83C\uDFDB️"}),(0,l.jsx)("p",{className:"text-gray-500 mb-2",children:"No teachers ready for final review"}),(0,l.jsx)("p",{className:"text-sm text-gray-400",children:"Teachers will appear here once their HOD and Assistant Dean reviews are completed"})]})]})}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-6",children:[(0,l.jsx)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:(0,l.jsx)("div",{className:"p-5",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"flex-shrink-0",children:(0,l.jsx)("div",{className:"w-8 h-8 bg-yellow-500 rounded-full flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-white text-sm font-medium",children:"⏳"})})}),(0,l.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,l.jsxs)("dl",{children:[(0,l.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Pending"}),(0,l.jsx)("dd",{className:"text-lg font-medium text-gray-900",children:t.filter(e=>{let t=N(e,"START"),s=N(e,"END");return"PENDING"===t.status||"PENDING"===s.status}).length})]})})]})})}),(0,l.jsx)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:(0,l.jsx)("div",{className:"p-5",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"flex-shrink-0",children:(0,l.jsx)("div",{className:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-white text-sm font-medium",children:"✅"})})}),(0,l.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,l.jsxs)("dl",{children:[(0,l.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Promoted"}),(0,l.jsx)("dd",{className:"text-lg font-medium text-gray-900",children:t.filter(e=>{let t=N(e,"START"),s=N(e,"END");return"PROMOTED"===t.text||"PROMOTED"===s.text}).length})]})})]})})}),(0,l.jsx)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:(0,l.jsx)("div",{className:"p-5",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"flex-shrink-0",children:(0,l.jsx)("div",{className:"w-8 h-8 bg-yellow-500 rounded-full flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-white text-sm font-medium",children:"⏸️"})})}),(0,l.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,l.jsxs)("dl",{children:[(0,l.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"On Hold"}),(0,l.jsx)("dd",{className:"text-lg font-medium text-gray-900",children:t.filter(e=>{let t=N(e,"START"),s=N(e,"END");return"ON_HOLD"===t.text||"ON_HOLD"===s.text}).length})]})})]})})}),(0,l.jsx)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:(0,l.jsx)("div",{className:"p-5",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"flex-shrink-0",children:(0,l.jsx)("div",{className:"w-8 h-8 bg-red-500 rounded-full flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-white text-sm font-medium",children:"\uD83D\uDCC8"})})}),(0,l.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,l.jsxs)("dl",{children:[(0,l.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Needs Improvement"}),(0,l.jsx)("dd",{className:"text-lg font-medium text-gray-900",children:t.filter(e=>{let t=N(e,"START"),s=N(e,"END");return"NEEDS_IMPROVEMENT"===t.text||"NEEDS_IMPROVEMENT"===s.text}).length})]})})]})})}),(0,l.jsx)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:(0,l.jsx)("div",{className:"p-5",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"flex-shrink-0",children:(0,l.jsx)("div",{className:"w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-white text-sm font-medium",children:"\uD83C\uDFE2"})})}),(0,l.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,l.jsxs)("dl",{children:[(0,l.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Departments"}),(0,l.jsx)("dd",{className:"text-lg font-medium text-gray-900",children:new Set(t.map(e=>e.department.name)).size})]})})]})})})]})]})})})}},35695:(e,t,s)=>{"use strict";var l=s(18999);s.o(l,"useParams")&&s.d(t,{useParams:function(){return l.useParams}}),s.o(l,"useRouter")&&s.d(t,{useRouter:function(){return l.useRouter}})},42355:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});let l=(0,s(19946).A)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},77475:(e,t,s)=>{Promise.resolve().then(s.bind(s,23458))}},e=>{e.O(0,[6169,2108,699,8892,8441,5964,7358],()=>e(e.s=77475)),_N_E=e.O()}]);