(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2331],{26126:(e,t,s)=>{"use strict";s.d(t,{E:()=>d});var a=s(95155);s(12115);var r=s(99708),i=s(74466),n=s(59434);let l=(0,i.F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function d(e){let{className:t,variant:s,asChild:i=!1,...d}=e,o=i?r.DX:"span";return(0,a.jsx)(o,{"data-slot":"badge",className:(0,n.cn)(l({variant:s}),t),...d})}},42355:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},56708:(e,t,s)=>{Promise.resolve().then(s.bind(s,64481))},59409:(e,t,s)=>{"use strict";s.d(t,{bq:()=>m,eb:()=>u,gC:()=>x,l6:()=>o,yv:()=>c});var a=s(95155);s(12115);var r=s(89912),i=s(66474),n=s(5196),l=s(47863),d=s(59434);function o(e){let{...t}=e;return(0,a.jsx)(r.bL,{"data-slot":"select",...t})}function c(e){let{...t}=e;return(0,a.jsx)(r.WT,{"data-slot":"select-value",...t})}function m(e){let{className:t,size:s="default",children:n,...l}=e;return(0,a.jsxs)(r.l9,{"data-slot":"select-trigger","data-size":s,className:(0,d.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...l,children:[n,(0,a.jsx)(r.In,{asChild:!0,children:(0,a.jsx)(i.A,{className:"size-4 opacity-50"})})]})}function x(e){let{className:t,children:s,position:i="popper",...n}=e;return(0,a.jsx)(r.ZL,{children:(0,a.jsxs)(r.UC,{"data-slot":"select-content",className:(0,d.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:i,...n,children:[(0,a.jsx)(h,{}),(0,a.jsx)(r.LM,{className:(0,d.cn)("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:s}),(0,a.jsx)(v,{})]})})}function u(e){let{className:t,children:s,...i}=e;return(0,a.jsxs)(r.q7,{"data-slot":"select-item",className:(0,d.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...i,children:[(0,a.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,a.jsx)(r.VF,{children:(0,a.jsx)(n.A,{className:"size-4"})})}),(0,a.jsx)(r.p4,{children:s})]})}function h(e){let{className:t,...s}=e;return(0,a.jsx)(r.PP,{"data-slot":"select-scroll-up-button",className:(0,d.cn)("flex cursor-default items-center justify-center py-1",t),...s,children:(0,a.jsx)(l.A,{className:"size-4"})})}function v(e){let{className:t,...s}=e;return(0,a.jsx)(r.wn,{"data-slot":"select-scroll-down-button",className:(0,d.cn)("flex cursor-default items-center justify-center py-1",t),...s,children:(0,a.jsx)(i.A,{className:"size-4"})})}},62523:(e,t,s)=>{"use strict";s.d(t,{p:()=>n});var a=s(95155),r=s(12115),i=s(59434);let n=r.forwardRef(function(e,t){let{className:s,type:r,...n}=e;return(0,a.jsx)("input",{ref:t,type:r,"data-slot":"input",className:(0,i.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",s),...n})});n.displayName="Input"},64481:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>v});var a=s(95155),r=s(12115),i=s(35695),n=s(79783),l=s(12638),d=s(30285),o=s(62523),c=s(88539),m=s(26126),x=s(59409),u=s(56671);function h(e){var t;let{teacherId:s,term:i,onSubmit:n,onCancel:l,loading:h=!1}=e,[v,g]=(0,r.useState)(null),[b,p]=(0,r.useState)(""),[f,j]=(0,r.useState)(0),[N,y]=(0,r.useState)("PROMOTED"),[w,S]=(0,r.useState)(!0),[F,k]=(0,r.useState)("");(0,r.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/reviews/dean/teacher-data?teacherId=".concat(s,"&term=").concat(i));if(!e.ok)throw Error("Failed to fetch teacher data");let t=await e.json();g(t),t.existingFinalReview?(p(t.existingFinalReview.finalComment),j(t.existingFinalReview.finalScore),y(t.existingFinalReview.status)):j(t.scoringSummary.averageScore)}catch(e){k("Failed to load teacher data"),u.oR.error("Failed to load teacher data")}finally{S(!1)}})()},[s,i]);let R=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if((null==v?void 0:v.canEdit)||e){if(!b.trim()){k("Final comment is required"),u.oR.error("Final comment is required");return}if(f<0){k("Final score cannot be negative"),u.oR.error("Final score cannot be negative");return}n({finalComment:b.trim(),finalScore:f,status:N,submitted:e})}};if(w)return(0,a.jsx)("div",{className:"flex items-center justify-center min-h-64",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});if(F&&!v)return(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Failed to load teacher data."});if(!v)return(0,a.jsx)("div",{className:"text-center py-8",children:(0,a.jsx)("p",{className:"text-gray-500",children:"No data available"})});let C=(null==(t=v.existingFinalReview)?void 0:t.submitted)||!1;return(0,a.jsx)("div",{className:"max-w-6xl mx-auto",children:(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200 bg-gradient-to-r from-indigo-50 to-blue-50",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Dean Final Review"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:[v.teacher.name," - ",v.teacher.department.name," - ",i," Term"]})]}),C&&(0,a.jsx)(m.E,{className:"bg-green-100 text-green-800",children:"Submitted"})]})}),(0,a.jsxs)("div",{className:"p-6",children:[F&&(0,a.jsx)("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:F}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Teacher's Responses"}),(0,a.jsx)("div",{className:"space-y-6",children:v.answers.map((e,t)=>(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,a.jsxs)("h4",{className:"text-sm font-medium text-gray-900",children:["Question ",t+1]}),(0,a.jsx)("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded",children:e.question.type})]}),(0,a.jsx)("p",{className:"text-gray-700 mb-3",children:e.question.question}),(0,a.jsxs)("div",{className:"bg-blue-50 rounded p-3",children:[(0,a.jsx)("p",{className:"text-sm text-blue-900 font-medium mb-1",children:"Teacher's Answer:"}),(0,a.jsx)("div",{className:"text-blue-800",children:(()=>{try{let t="string"==typeof e.answer?JSON.parse(e.answer):null;if(t&&t.details&&"object"==typeof t.details){let e=Object.entries(t.details).filter(e=>{let[,t]=e;return(t||"").trim().length>0});if(e.length>0)return(0,a.jsx)("div",{className:"space-y-1",children:e.map(e=>{let[t,s]=e;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{className:"font-semibold",children:[t,":"]})," ",s]},t)})})}}catch(e){}return(0,a.jsx)("span",{children:String(e.answer)})})()})]})]},e.id))}),(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Teacher's Self-Assessment Comment"}),(0,a.jsx)("div",{className:"bg-blue-50 rounded p-3",children:(0,a.jsx)("p",{className:"text-blue-800",children:v.selfComment})})]}),(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"HOD Review"}),(0,a.jsxs)("div",{className:"bg-green-50 rounded p-3",children:[(0,a.jsx)("p",{className:"text-green-800",children:v.hodReview.comments}),(0,a.jsxs)("p",{className:"text-sm text-green-700 mt-2",children:["Score: ",v.hodReview.totalScore,"%"]})]})]}),(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Assistant Dean Review"}),(0,a.jsxs)("div",{className:"bg-purple-50 rounded p-3",children:[(0,a.jsx)("p",{className:"text-purple-800",children:v.asstReview.comments}),(0,a.jsxs)("p",{className:"text-sm text-purple-700 mt-2",children:["Score: ",v.asstReview.totalScore,"%"]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Final Review"}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:["Average Score: ",(0,a.jsxs)("span",{className:"font-semibold",children:[v.scoringSummary.averageScore,"%"]})]})]}),(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 bg-blue-50",children:[(0,a.jsx)("h4",{className:"text-md font-medium text-blue-900 mb-4",children:"Scoring Overview"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-800",children:v.scoringSummary.hodTotalScore}),(0,a.jsx)("div",{className:"text-sm text-blue-600",children:"HOD Score"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-800",children:v.scoringSummary.asstTotalScore}),(0,a.jsx)("div",{className:"text-sm text-blue-600",children:"Asst Dean Score"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-800",children:v.scoringSummary.averageScore}),(0,a.jsx)("div",{className:"text-sm text-blue-600",children:"Average Score"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-800",children:v.scoringSummary.maxPossibleScore}),(0,a.jsx)("div",{className:"text-sm text-blue-600",children:"Max Possible"})]})]}),(0,a.jsx)("div",{className:"mt-4 text-center",children:(0,a.jsxs)("div",{className:"text-sm text-blue-700",children:["Performance: ",Math.round(v.scoringSummary.averageScore/v.scoringSummary.maxPossibleScore*100),"%"]})})]}),(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Final Score"}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("label",{htmlFor:"finalScore",className:"block text-sm font-medium text-gray-700",children:"Final Score (0-100%):"}),(0,a.jsx)(o.p,{id:"finalScore",type:"number",min:"0",max:"100",value:f,onChange:e=>j(parseInt(e.target.value)||0),className:"w-24",disabled:!v.canEdit}),(0,a.jsx)("span",{className:"text-sm text-gray-500",children:"%"})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"Enter the final score based on all evaluations and your assessment"})]}),(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Promotion Status"}),(0,a.jsxs)(x.l6,{value:N,onValueChange:e=>y(e),disabled:!v.canEdit,children:[(0,a.jsx)(x.bq,{children:(0,a.jsx)(x.yv,{})}),(0,a.jsxs)(x.gC,{children:[(0,a.jsx)(x.eb,{value:"PROMOTED",children:"Promoted"}),(0,a.jsx)(x.eb,{value:"ON_HOLD",children:"On Hold"}),(0,a.jsx)(x.eb,{value:"NEEDS_IMPROVEMENT",children:"Needs Improvement"})]})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"Select the appropriate promotion status based on the evaluation"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"finalComment",className:"block text-sm font-medium text-gray-700 mb-2",children:"Final Comments"}),(0,a.jsx)(c.T,{id:"finalComment",value:b,onChange:e=>p(e.target.value),rows:6,className:"w-full",placeholder:"Provide your final assessment and recommendations...",disabled:!v.canEdit,required:!0}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"Include your final assessment, recommendations, and any additional comments"})]}),v.canEdit&&(0,a.jsxs)("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[(0,a.jsx)(d.$,{variant:"outline",onClick:l,disabled:h,children:"Cancel"}),(0,a.jsx)(d.$,{variant:"outline",onClick:()=>R(!1),disabled:h,children:h?"Saving...":"Save Draft"}),(0,a.jsx)(d.$,{onClick:()=>R(!0),disabled:h,children:h?"Submitting...":"Submit Final Review"})]}),C&&(0,a.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-md p-4",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("span",{className:"text-green-400 text-xl",children:"✓"})}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-green-800",children:"Final Review Submitted"}),(0,a.jsx)("p",{className:"text-sm text-green-700 mt-1",children:"Your final review has been successfully submitted and is now part of the evaluation process."})]})]})})]})]})]})]})})}function v(e){let{params:t}=e,[s,d]=(0,r.useState)(!1),[o,c]=(0,r.useState)(""),[m,x]=(0,r.useState)(""),u=(0,i.useRouter)(),{teacherId:v,term:g}=t,b=async e=>{d(!0),c(""),x("");try{let t=await fetch("/api/reviews/dean",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teacherId:v,term:g,...e})});if(t.ok){let t=e.submitted?"Final decision submitted successfully! This evaluation is now complete and immutable.":"Final review saved as draft!";x(t),e.submitted&&setTimeout(()=>{u.push("/dashboard/dean/reviews")},3e3)}else{let e=await t.json();c(e.error||"Failed to save final review")}}catch(e){c("Error saving final review")}finally{d(!1)}};return(0,a.jsx)(n.A,{allowedRoles:["DEAN"],children:(0,a.jsx)(l.A,{title:"Dean Final Review - ".concat(g," Term"),children:(0,a.jsxs)("div",{className:"space-y-6",children:[o&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:o}),m&&(0,a.jsx)("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded",children:m}),(0,a.jsx)(h,{teacherId:v,term:g,onSubmit:b,onCancel:()=>{u.push("/dashboard/dean/reviews")},loading:s})]})})})}},88539:(e,t,s)=>{"use strict";s.d(t,{T:()=>i});var a=s(95155);s(12115);var r=s(59434);function i(e){let{className:t,...s}=e;return(0,a.jsx)("textarea",{"data-slot":"textarea",className:(0,r.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...s})}}},e=>{e.O(0,[6169,2108,699,7754,6671,6304,8892,8441,5964,7358],()=>e(e.s=56708)),_N_E=e.O()}]);