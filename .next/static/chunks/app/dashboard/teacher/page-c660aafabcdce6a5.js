(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7e3],{26126:(e,t,a)=>{"use strict";a.d(t,{E:()=>l});var s=a(95155);a(12115);var r=a(99708),n=a(74466),i=a(59434);let o=(0,n.F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:t,variant:a,asChild:n=!1,...l}=e,d=n?r.DX:"span";return(0,s.jsx)(d,{"data-slot":"badge",className:(0,i.cn)(o({variant:a}),t),...l})}},28857:(e,t,a)=>{"use strict";a.d(t,{k:()=>w});var s=a(95155),r=a(12115),n=a(46081),i=a(63655),o="Progress",[l,d]=(0,n.A)(o),[c,u]=l(o),m=r.forwardRef((e,t)=>{var a,r,n,o;let{__scopeProgress:l,value:d=null,max:u,getValueLabel:m=g,...h}=e;(u||0===u)&&!p(u)&&console.error((a="".concat(u),r="Progress","Invalid prop `max` of value `".concat(a,"` supplied to `").concat(r,"`. Only numbers greater than 0 are valid max values. Defaulting to `").concat(100,"`.")));let v=p(u)?u:100;null===d||y(d,v)||console.error((n="".concat(d),o="Progress","Invalid prop `value` of value `".concat(n,"` supplied to `").concat(o,"`. The `value` prop must be:\n  - a positive number\n  - less than the value passed to `max` (or ").concat(100," if no `max` prop is set)\n  - `null` or `undefined` if the progress is indeterminate.\n\nDefaulting to `null`.")));let b=y(d,v)?d:null,w=x(b)?m(b,v):void 0;return(0,s.jsx)(c,{scope:l,value:b,max:v,children:(0,s.jsx)(i.sG.div,{"aria-valuemax":v,"aria-valuemin":0,"aria-valuenow":x(b)?b:void 0,"aria-valuetext":w,role:"progressbar","data-state":f(b,v),"data-value":null!=b?b:void 0,"data-max":v,...h,ref:t})})});m.displayName=o;var h="ProgressIndicator",v=r.forwardRef((e,t)=>{var a;let{__scopeProgress:r,...n}=e,o=u(h,r);return(0,s.jsx)(i.sG.div,{"data-state":f(o.value,o.max),"data-value":null!=(a=o.value)?a:void 0,"data-max":o.max,...n,ref:t})});function g(e,t){return"".concat(Math.round(e/t*100),"%")}function f(e,t){return null==e?"indeterminate":e===t?"complete":"loading"}function x(e){return"number"==typeof e}function p(e){return x(e)&&!isNaN(e)&&e>0}function y(e,t){return x(e)&&!isNaN(e)&&e<=t&&e>=0}v.displayName=h;var b=a(59434);function w(e){let{className:t,value:a,indicatorClassName:r,trackClassName:n,...i}=e;return(0,s.jsx)(m,{"data-slot":"progress",className:(0,b.cn)("relative h-2 w-full overflow-hidden rounded-full",n||"bg-primary/20",t),...i,children:(0,s.jsx)(v,{"data-slot":"progress-indicator",className:(0,b.cn)("h-full w-full flex-1 transition-all bg-primary",r),style:{transform:"translateX(-".concat(100-(a||0),"%)")}})})}},35695:(e,t,a)=>{"use strict";var s=a(18999);a.o(s,"useParams")&&a.d(t,{useParams:function(){return s.useParams}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}})},42355:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(19946).A)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},46081:(e,t,a)=>{"use strict";a.d(t,{A:()=>i,q:()=>n});var s=a(12115),r=a(95155);function n(e,t){let a=s.createContext(t),n=e=>{let{children:t,...n}=e,i=s.useMemo(()=>n,Object.values(n));return(0,r.jsx)(a.Provider,{value:i,children:t})};return n.displayName=e+"Provider",[n,function(r){let n=s.useContext(a);if(n)return n;if(void 0!==t)return t;throw Error(`\`${r}\` must be used within \`${e}\``)}]}function i(e,t=[]){let a=[],n=()=>{let t=a.map(e=>s.createContext(e));return function(a){let r=a?.[e]||t;return s.useMemo(()=>({[`__scope${e}`]:{...a,[e]:r}}),[a,r])}};return n.scopeName=e,[function(t,n){let i=s.createContext(n),o=a.length;a=[...a,n];let l=t=>{let{scope:a,children:n,...l}=t,d=a?.[e]?.[o]||i,c=s.useMemo(()=>l,Object.values(l));return(0,r.jsx)(d.Provider,{value:c,children:n})};return l.displayName=t+"Provider",[l,function(a,r){let l=r?.[e]?.[o]||i,d=s.useContext(l);if(d)return d;if(void 0!==n)return n;throw Error(`\`${a}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let a=()=>{let a=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let r=a.reduce((t,{useScope:a,scopeName:s})=>{let r=a(e)[`__scope${s}`];return{...t,...r}},{});return s.useMemo(()=>({[`__scope${t.scopeName}`]:r}),[r])}};return a.scopeName=t.scopeName,a}(n,...t)]}},49699:(e,t,a)=>{"use strict";a.d(t,{w:()=>i});var s=a(12115),r=a(12108);let n={evaluationStatus:null,startData:null,endData:null,termState:null,isLoading:!1,hasData:!1};function i(){let{data:e,status:t}=(0,r.useSession)(),[a,i]=(0,s.useState)(!1),[o,l]=(0,s.useState)(null),d=(0,s.useCallback)(async()=>{if(!n.isLoading&&(!n.hasData||a)){n.isLoading=!0,i(!0),l(null);try{var t;let a=null==e||null==(t=e.user)?void 0:t.departmentId;if(!a)throw Error("No department ID found");let[s,r]=await Promise.all([fetch("/api/teacher-evaluation/status"),fetch("/api/departments/".concat(a,"/term-state"))]);if(!s.ok||!r.ok)throw Error("Failed to load teacher data");let i=await s.json(),o=await r.json(),l=i.data||i,d=o.data||o;n={evaluationStatus:l,startData:null,endData:null,termState:d,isLoading:!1,hasData:!0}}catch(e){l(e instanceof Error?e.message:"Failed to load data"),n.isLoading=!1,n.evaluationStatus=null,n.termState=null}finally{i(!1)}}},[e]),c=(0,s.useCallback)(async e=>{try{let t=await fetch("/api/teacher-evaluation/questions?term=".concat(e));if(!t.ok)throw Error("Failed to fetch ".concat(e," evaluation data"));let a=await t.json(),s=a.data||a;return"START"===e?n.startData=s:n.endData=s,s}catch(e){throw e}},[]),u=(0,s.useCallback)(()=>{n.hasData=!1,n.evaluationStatus=null,n.startData=null,n.endData=null,n.termState=null},[]),m=(0,s.useCallback)(()=>{u(),d()},[d,u]);return(0,s.useEffect)(()=>{var a;"authenticated"!==t||(null==e||null==(a=e.user)?void 0:a.role)!=="TEACHER"||n.hasData||d()},[t,e,d]),(0,s.useEffect)(()=>{!n.evaluationStatus||n.startData||n.endData||(async()=>{try{var e,t,a,s;(null==(t=n.evaluationStatus)||null==(e=t.start)?void 0:e.status)!=="NOT_AVAILABLE"&&await c("START"),(null==(s=n.evaluationStatus)||null==(a=s.end)?void 0:a.status)!=="NOT_AVAILABLE"&&await c("END")}catch(e){console.warn("Auto-fetch of term data failed:",e)}})()},[n.evaluationStatus,n.startData,n.endData,c]),(0,s.useEffect)(()=>{"unauthenticated"===t&&u()},[t,u]),{evaluationStatus:(e=>{if(!e)return null;let t={...e};return t.start&&(t.start.answersCount=Math.min(t.start.answersCount||0,t.start.questionsCount||0)),t.end&&(t.end.answersCount=Math.min(t.end.answersCount||0,t.end.questionsCount||0)),t})(n.evaluationStatus),startData:n.startData,endData:n.endData,termState:n.termState,loading:a||n.isLoading,error:o,refetch:m,invalidateCache:u,fetchTermData:c,submitAnswers:(0,s.useCallback)(async(e,t,a)=>{try{let s=await fetch("/api/teacher-answers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({answers:e,selfComment:t,term:a})});if(!s.ok)throw Error("Failed to submit answers");let r=await s.json(),i=r.data||r;try{let e=await fetch("/api/teacher-evaluation/status");if(e.ok){let t=await e.json(),a=t.data||t;n.evaluationStatus=a}}catch(e){console.warn("Failed to fetch fresh status after submission:",e)}return i}catch(e){throw e}},[]),getEvaluationReport:(0,s.useCallback)(async e=>{try{let t=await fetch("/api/reviews/teacher/evaluation-report?term=".concat(e));if(!t.ok)throw Error("Failed to get evaluation report");let a=await t.json();return a.data||a}catch(e){throw e}},[]),fetchEvaluation:(0,s.useCallback)(async e=>{try{let t=await fetch("/api/teacher-evaluation/".concat(e));if(!t.ok)throw Error("Failed to fetch evaluation");let a=await t.json();return a.data||a}catch(e){throw e}},[]),updateEvaluation:(0,s.useCallback)(async(e,t)=>{try{let a=await fetch("/api/teacher-evaluation/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!a.ok)throw Error("Failed to update evaluation");let s=await a.json(),r=s.data||s;return{success:!0,evaluation:r}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error"}}},[]),fetchQuestions:(0,s.useCallback)(async e=>{try{let t=await fetch("/api/teacher-evaluation/questions?term=".concat(e));if(!t.ok)throw Error("Failed to fetch ".concat(e," questions"));let a=await t.json();return a.data||a}catch(e){throw e}},[]),updateAnswers:(0,s.useCallback)(async e=>{try{let t=await fetch("/api/teacher-answers",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("Failed to update answers");let a=await t.json();return a.data||a}catch(e){throw e}},[])}}},51154:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(19946).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},55365:(e,t,a)=>{"use strict";a.d(t,{Fc:()=>l,TN:()=>d});var s=a(95155),r=a(12115),n=a(74466),i=a(59434);let o=(0,n.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),l=r.forwardRef((e,t)=>{let{className:a,variant:r,...n}=e;return(0,s.jsx)("div",{ref:t,role:"alert",className:(0,i.cn)(o({variant:r}),a),...n})});l.displayName="Alert",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("h5",{ref:t,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",a),...r})}).displayName="AlertTitle";let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",a),...r})});d.displayName="AlertDescription"},57434:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(19946).A)("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},60002:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>k});var s=a(95155),r=a(12108),n=a(12115),i=a(79783),o=a(12638),l=a(49699),d=a(55365),c=a(30285),u=a(51154),m=a(66695),h=a(26126);let v=(0,n.memo)(function(e){let{userName:t,departmentName:a,evaluationStatus:r,departmentStates:n,departmentId:i}=e;return(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsx)(m.Zp,{className:"bg-gradient-to-r from-blue-50 to-indigo-100 shadow-md",children:(0,s.jsxs)(m.Wu,{className:"py-6 flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"text-lg font-semibold text-gray-900",children:["Welcome, ",t||"Teacher","!"]}),(0,s.jsxs)("div",{className:"text-sm text-gray-600",children:["Department: ",(0,s.jsx)("span",{className:"font-medium",children:a||"—"})]}),(null==r?void 0:r.activeTerm)&&(0,s.jsx)("div",{className:"text-sm text-blue-600 font-medium",children:(()=>{let e=r.activeTerm,t=n[i||""];return("START"===e?(null==t?void 0:t.startTermVisibility)==="COMPLETE":(null==t?void 0:t.endTermVisibility)==="COMPLETE")?(0,s.jsxs)("span",{className:"text-purple-600",children:["Term Completed: ",e]}):(0,s.jsxs)("span",{className:"text-blue-600",children:["Active Term: ",e]})})()})]}),(0,s.jsx)(h.E,{variant:"secondary",className:"text-base",children:"Teacher"})]})})})});var g=a(6874),f=a.n(g),x=a(28857),p=a(85690);let y=(0,a(19946).A)("calendar-days",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);var b=a(92657);let w={NOT_AVAILABLE:{label:"Not Available",color:"secondary"},NOT_STARTED:{label:"Not Started",color:"destructive"},IN_PROGRESS:{label:"In Progress",color:"secondary"},SUBMITTED:{label:"Submitted",color:"default"},REVIEWED:{label:"Reviewed",color:"success"}},N=(0,n.memo)(function(e){var t,a;let{title:r,subtitle:n,term:i,questionsCount:o,answersCount:l,status:d,deadline:u,_isSubmitted:v}=e,g=Math.min(l,o),N=o>0?Math.min(Math.round(g/o*100),100):0,E="SUBMITTED"===d,j="NOT_AVAILABLE"===d,A="START"===i;return(0,s.jsxs)(m.Zp,{className:"shadow-lg",children:[(0,s.jsx)(m.aR,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("div",{className:"h-9 w-9 rounded-md flex items-center justify-center mt-0.5 ".concat(E||A?"bg-emerald-100 text-emerald-700":"bg-amber-100 text-amber-700"),children:A?(0,s.jsx)(p.A,{className:"h-4 w-4"}):(0,s.jsx)(y,{className:"h-4 w-4"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)(m.ZB,{children:r}),(0,s.jsx)(m.BT,{children:n})]})]}),(0,s.jsx)(h.E,{className:E?"bg-emerald-100 text-emerald-700":"IN_PROGRESS"===d?"bg-amber-100 text-amber-700":"NOT_STARTED"===d?"bg-rose-100 text-rose-700":"",variant:(null==(t=w[d])?void 0:t.color)||"secondary",children:(null==(a=w[d])?void 0:a.label)||d})]})}),(0,s.jsxs)(m.Wu,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"Progress"}),(0,s.jsxs)("span",{className:"text-sm text-gray-500",children:[N,"%"]})]}),(0,s.jsx)(x.k,{value:N,trackClassName:"bg-gray-200",indicatorClassName:"bg-green-500"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,s.jsx)("span",{className:"text-gray-500",children:E?"Submitted on:":"Deadline:"}),(0,s.jsx)("span",{className:"font-medium text-gray-900 ".concat(E?"":A?"text-amber-600":"text-red-600"),children:E?new Date().toLocaleDateString():u?new Date(u).toLocaleDateString():"—"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,s.jsx)("span",{className:"text-gray-500",children:"Questions completed:"}),(0,s.jsxs)("span",{className:"font-medium text-gray-900",children:[g,"/",o]})]}),(0,s.jsx)("div",{className:"mt-6 flex space-x-3",children:E||"REVIEWED"===d?(0,s.jsx)(c.$,{asChild:!0,className:"flex-1 bg-gray-100 text-gray-700 px-4 py-2 rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors border-0",children:(0,s.jsxs)(f(),{href:"/dashboard/teacher/evaluation/".concat(i),children:[(0,s.jsx)(b.A,{className:"w-4 h-4 mr-2"}),"View Submission"]})}):j?(0,s.jsx)(c.$,{disabled:!0,className:"flex-1 bg-gray-100 text-gray-700 px-4 py-2 rounded-lg text-sm font-medium",children:"Not Available"}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.$,{className:"flex-1 bg-gray-100 text-gray-700 px-4 py-2 rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors",children:"Save Draft"}),(0,s.jsx)(c.$,{asChild:!0,className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors",children:(0,s.jsxs)(f(),{href:"/dashboard/teacher/evaluation/".concat(i),children:[(0,s.jsx)(p.A,{className:"w-4 h-4 mr-2"}),"Continue"]})})]})})]})]})}),E=(0,n.memo)(function(e){var t,a,r,n,i,o;let{evaluationStatus:l,_startData:d,_endData:c,startAnswersCount:u,endAnswersCount:m,startQuestionsCount:h,endQuestionsCount:v}=e;return l?(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-8",children:[(0,s.jsx)(N,{title:"Start of Year Assessment",subtitle:"Self-evaluation and goal setting",term:"START",questionsCount:h,answersCount:u,status:(null==(t=l.start)?void 0:t.status)||"NOT_AVAILABLE",deadline:(null==(a=l.start)?void 0:a.deadline)||null,isSubmitted:(null==(r=l.start)?void 0:r.status)==="SUBMITTED"}),(0,s.jsx)(N,{title:"End of Year Reflection",subtitle:"Annual performance review",term:"END",questionsCount:v,answersCount:m,status:(null==(n=l.end)?void 0:n.status)||"NOT_AVAILABLE",deadline:(null==(i=l.end)?void 0:i.deadline)||null,isSubmitted:(null==(o=l.end)?void 0:o.status)==="SUBMITTED"})]}):(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-8",children:[(0,s.jsx)(N,{title:"Start of Year Assessment",subtitle:"Self-evaluation and goal setting",term:"START",questionsCount:h,answersCount:u,status:"NOT_AVAILABLE",deadline:null,isSubmitted:!1}),(0,s.jsx)(N,{title:"End of Year Reflection",subtitle:"Annual performance review",term:"END",questionsCount:v,answersCount:m,status:"NOT_AVAILABLE",deadline:null,isSubmitted:!1})]})});var j=a(57434),A=a(91788);let T=(0,n.memo)(function(e){var t,a,r,i;let{evaluationStatus:o,localLoading:l,_userName:d,onDownloadReport:h}=e,v=(0,n.useCallback)(e=>{h(e)},[h]);return o&&((null==(t=o.start)?void 0:t.status)==="REVIEWED"||(null==(a=o.end)?void 0:a.status)==="REVIEWED")?(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsxs)(m.Zp,{children:[(0,s.jsxs)(m.aR,{children:[(0,s.jsxs)(m.ZB,{className:"flex items-center gap-2",children:[(0,s.jsx)(j.A,{className:"h-5 w-5"}),"Download Evaluation Report"]}),(0,s.jsx)(m.BT,{children:"Download your performance evaluation report (only available after Dean finalizes)"})]}),(0,s.jsx)(m.Wu,{children:(0,s.jsxs)("div",{className:"space-y-4",children:[(null==(r=o.start)?void 0:r.status)==="REVIEWED"&&(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-green-50",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"h-10 w-10 rounded-full bg-green-100 flex items-center justify-center",children:(0,s.jsx)(j.A,{className:"h-5 w-5 text-green-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-gray-900",children:"Start Term Evaluation Report"}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:"Ready for download"})]})]}),(0,s.jsxs)(c.$,{variant:"default",size:"sm",onClick:()=>v("START"),disabled:l,children:[l?(0,s.jsx)(u.A,{className:"h-4 w-4 mr-2 animate-spin"}):(0,s.jsx)(A.A,{className:"h-4 w-4 mr-2"}),l?"Generating...":"Download PDF"]})]}),(null==(i=o.end)?void 0:i.status)==="REVIEWED"&&(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-green-50",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"h-10 w-10 rounded-full bg-green-100 flex items-center justify-center",children:(0,s.jsx)(j.A,{className:"h-5 w-5 text-green-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-gray-900",children:"End Term Evaluation Report"}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:"Ready for download"})]})]}),(0,s.jsxs)(c.$,{variant:"default",size:"sm",onClick:()=>v("END"),disabled:l,children:[l?(0,s.jsx)(u.A,{className:"h-4 w-4 mr-2 animate-spin"}):(0,s.jsx)(A.A,{className:"h-4 w-4 mr-2"}),l?"Generating...":"Download PDF"]})]})]})})]})}):null});var S=a(15080),D=a(56671);let R={UNAUTHORIZED:{title:"Access Denied",message:"You do not have permission to perform this action.",suggestion:"Please contact your administrator if you believe this is an error.",severity:"error"},FORBIDDEN:{title:"Access Restricted",message:"This resource is not accessible with your current permissions.",suggestion:"Please check your role and department access.",severity:"error"},INVALID_SESSION:{title:"Session Expired",message:"Your session has expired. Please log in again.",suggestion:"Click the logout button and sign in again.",severity:"warning"},NOT_FOUND:{title:"Resource Not Found",message:"The requested information could not be found.",suggestion:"Please refresh the page or check if the resource still exists.",severity:"warning"},ALREADY_EXISTS:{title:"Duplicate Entry",message:"This item already exists in the system.",suggestion:"Please check for existing entries or use a different identifier.",severity:"warning"},VALIDATION_FAILED:{title:"Invalid Information",message:"Please check the information you entered and try again.",suggestion:"Ensure all required fields are filled correctly.",severity:"info"},DATABASE_ERROR:{title:"System Error",message:"We encountered a technical issue while processing your request.",suggestion:"Please try again in a few moments. If the problem persists, contact support.",severity:"error"},NETWORK_ERROR:{title:"Connection Error",message:"Unable to connect to the server. Please check your internet connection.",suggestion:"Try refreshing the page or check your network connection.",severity:"warning"},TIMEOUT:{title:"Request Timeout",message:"The operation took too long to complete.",suggestion:"Please try again. If the problem continues, contact support.",severity:"warning"},INVALID_TERM:{title:"Invalid Term",message:"The selected term is not valid for this operation.",suggestion:"Please select a valid term from the dropdown.",severity:"warning"},TERM_NOT_ACTIVE:{title:"Term Not Active",message:"This operation cannot be performed on an inactive term.",suggestion:"Please select an active term or wait for the term to become active.",severity:"warning"},ALREADY_SUBMITTED:{title:"Already Submitted",message:"This evaluation has already been submitted and cannot be modified.",suggestion:"Contact your administrator if you need to make changes.",severity:"info"},DEADLINE_PASSED:{title:"Deadline Passed",message:"The submission deadline for this evaluation has passed.",suggestion:"Contact your administrator if you need an extension.",severity:"warning"},UNKNOWN_ERROR:{title:"Unexpected Error",message:"An unexpected error occurred. Please try again.",suggestion:"If the problem persists, contact your system administrator.",severity:"error"},OPERATION_FAILED:{title:"Operation Failed",message:"The operation could not be completed successfully.",suggestion:"Please try again or contact support if the issue continues.",severity:"error"}};function C(e,t){if(e&&"object"==typeof e&&"title"in e&&"message"in e)return e;let a="UNKNOWN_ERROR";e instanceof Error?(e.message,e.message.includes("Unauthorized")||e.message.includes("401")?a="UNAUTHORIZED":e.message.includes("Forbidden")||e.message.includes("403")?a="FORBIDDEN":e.message.includes("Not Found")||e.message.includes("404")?a="NOT_FOUND":e.message.includes("Validation")||e.message.includes("Invalid")?a="VALIDATION_FAILED":e.message.includes("Database")||e.message.includes("SQL")?a="DATABASE_ERROR":e.message.includes("Network")||e.message.includes("fetch")?a="NETWORK_ERROR":e.message.includes("timeout")||e.message.includes("Timeout")?a="TIMEOUT":e.message.includes("term")||e.message.includes("Term")?a="INVALID_TERM":e.message.includes("already submitted")||e.message.includes("submitted")?a="ALREADY_SUBMITTED":e.message.includes("deadline")||e.message.includes("Deadline")?a="DEADLINE_PASSED":(e.message.includes("already exists")||e.message.includes("duplicate"))&&(a="ALREADY_EXISTS")):"string"==typeof e&&(e.toLowerCase().includes("unauthorized")?a="UNAUTHORIZED":e.toLowerCase().includes("forbidden")?a="FORBIDDEN":e.toLowerCase().includes("not found")&&(a="NOT_FOUND"));let s=R[a]||R.UNKNOWN_ERROR;return{...s,message:"".concat(s.message," (").concat(t.operation,")")}}let k=(0,n.memo)(function(){var e,t,m,h,g,f;let{data:x}=(0,r.useSession)(),{evaluationStatus:p,startData:y,endData:b,termState:w,loading:N,error:j,refetch:A,submitAnswers:R,getEvaluationReport:k}=(0,l.w)(),{error:I,setError:O,clearError:M,handleError:_}=function(){let[e,t]=(0,n.useState)(null),a=(0,n.useCallback)(()=>{t(null)},[]),s=(0,n.useCallback)((e,a)=>{let s=C(e,a);t(s.message),"critical"===s.severity||"error"===s.severity?D.oR.error(s.message,{description:s.suggestion}):"warning"===s.severity?D.oR.warning(s.message,{description:s.suggestion}):D.oR.info(s.message,{description:s.suggestion})},[]),r=(0,n.useCallback)(async(e,s,r,n)=>{try{let t=await e();return a(),r&&r(t),t}catch(a){let e=C(a,s);return t(e.message),"critical"===e.severity||"error"===e.severity?D.oR.error(e.message,{description:e.suggestion}):"warning"===e.severity?D.oR.warning(e.message,{description:e.suggestion}):D.oR.info(e.message,{description:e.suggestion}),n&&n(e.message),null}},[a]);return{error:e,setError:t,clearError:a,handleError:s,handleAsyncError:r}}(),[P,F]=(0,n.useState)({}),[L,q]=(0,n.useState)({}),[V,U]=(0,n.useState)(""),[B,z]=(0,n.useState)(""),[W,$]=(0,n.useState)(!1),[H,Y]=(0,n.useState)(null),[Z,G]=(0,n.useState)({}),K=(0,n.useMemo)(()=>null==x?void 0:x.user,[x]),Q=(0,n.useMemo)(()=>(null==K?void 0:K.name)||void 0,[K]),X=(0,n.useMemo)(()=>(null==K?void 0:K.departmentName)||void 0,[K]),J=(0,n.useMemo)(()=>null==K?void 0:K.departmentId,[K]),ee=(0,n.useMemo)(()=>{var e,t;return Math.min((null==p||null==(e=p.start)?void 0:e.answersCount)||0,(null==p||null==(t=p.start)?void 0:t.questionsCount)||0)},[null==p||null==(e=p.start)?void 0:e.answersCount,null==p||null==(t=p.start)?void 0:t.questionsCount]),et=(0,n.useMemo)(()=>{var e,t;return Math.min((null==p||null==(e=p.end)?void 0:e.answersCount)||0,(null==p||null==(t=p.end)?void 0:t.questionsCount)||0)},[null==p||null==(m=p.end)?void 0:m.answersCount,null==p||null==(h=p.end)?void 0:h.questionsCount]),ea=(0,n.useMemo)(()=>{var e;return(null==p||null==(e=p.start)?void 0:e.questionsCount)||0},[null==p||null==(g=p.start)?void 0:g.questionsCount]),es=(0,n.useMemo)(()=>{var e;return(null==p||null==(e=p.end)?void 0:e.questionsCount)||0},[null==p||null==(f=p.end)?void 0:f.questionsCount]);(0,n.useEffect)(()=>{if(null==y?void 0:y.questions){let e={};y.questions.forEach(t=>{t.existingAnswer&&(e[t.id]=t.existingAnswer)}),F(e),U(y.existingSelfComment||"")}},[y]),(0,n.useEffect)(()=>{if(null==b?void 0:b.questions){let e={};b.questions.forEach(t=>{t.existingAnswer&&(e[t.id]=t.existingAnswer)}),q(e),z(b.existingSelfComment||"")}},[b]);let er=(0,n.useCallback)(async e=>{$(!0),M(),Y(null);try{let t=await k(e),{jsPDF:s}=await Promise.all([a.e(3930),a.e(913)]).then(a.bind(a,26597)),r=new s("p","mm","a4");r.setFontSize(20),r.text("Teacher Performance Evaluation Report",105,20,{align:"center"}),r.setFontSize(12),r.text("".concat(e," Term ").concat(new Date().getFullYear()),105,30,{align:"center"}),r.setFontSize(14),r.text("Teacher Information",20,50),r.setFontSize(10),r.text("Name: ".concat(Q||"N/A"),20,60),r.text("Department: ".concat(X||"N/A"),20,70),r.text("Term: ".concat(e),20,80);let n=100;(t.hodComment||t.hodScore||t.hodTotalScore)&&(r.setFontSize(14),r.text("HOD Evaluation",20,n),r.setFontSize(10),n+=10,t.hodComment&&(r.text("Comments: ".concat(t.hodComment),20,n),n+=10),null!==t.hodScore&&void 0!==t.hodScore&&(r.text("Overall Rating: ".concat(t.hodScore,"/10"),20,n),n+=10),null!==t.hodTotalScore&&void 0!==t.hodTotalScore&&(r.text("Rubric Total Score: ".concat(t.hodTotalScore),20,n),n+=10)),(t.asstDeanComment||t.asstDeanScore)&&(r.setFontSize(14),r.text("Assistant Dean Evaluation",20,n),r.setFontSize(10),n+=10,t.asstDeanComment&&(r.text("Comments: ".concat(t.asstDeanComment),20,n),n+=10),null!==t.asstDeanScore&&void 0!==t.asstDeanScore&&(r.text("Score: ".concat(t.asstDeanScore,"/10"),20,n),n+=10)),(t.deanComment||t.finalScore||void 0!==t.promoted)&&(r.setFontSize(14),r.text("Dean Final Review",20,n),r.setFontSize(10),n+=10,t.deanComment&&(r.text("Comments: ".concat(t.deanComment),20,n),n+=10),null!==t.finalScore&&void 0!==t.finalScore&&(r.text("Final Score: ".concat(t.finalScore,"/10"),20,n),n+=10),void 0!==t.promoted&&r.text("Promotion Status: ".concat(t.promoted?"PROMOTED":"NOT PROMOTED"),20,n));let i="".concat(Q||"Teacher","_").concat(e,"_").concat(new Date().getFullYear(),"_Evaluation.pdf");r.save(i),Y("Evaluation report downloaded successfully!")}catch(e){_(e,{operation:"download evaluation report",component:"TeacherDashboard"})}finally{$(!1)}},[k,Q,X,_]);return!K||N?(0,s.jsx)(i.A,{allowedRoles:["TEACHER"],children:(0,s.jsx)(o.A,{title:"Teacher Dashboard",children:(0,s.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,s.jsx)(u.A,{className:"w-8 h-8 animate-spin"})})})}):j?(0,s.jsx)(i.A,{allowedRoles:["TEACHER"],children:(0,s.jsx)(o.A,{title:"Teacher Dashboard",children:(0,s.jsx)(d.Fc,{className:"mb-4 border-red-200 bg-red-50",children:(0,s.jsxs)(d.TN,{className:"text-red-800",children:[j," - ",(0,s.jsx)(c.$,{onClick:A,variant:"outline",size:"sm",children:"Retry"})]})})})}):(0,s.jsx)(S.PageErrorBoundary,{pageName:"Teacher Dashboard",children:(0,s.jsx)(i.A,{allowedRoles:["TEACHER"],children:(0,s.jsxs)(o.A,{title:"Teacher Dashboard",children:[(0,s.jsx)(S.r0,{dataType:"teacher welcome data",children:(0,s.jsx)(v,{userName:Q,departmentName:X,evaluationStatus:p,departmentStates:Z,departmentId:J})}),I&&(0,s.jsx)(d.Fc,{className:"mb-4 border-red-200 bg-red-50",children:(0,s.jsx)(d.TN,{className:"text-red-800",children:I})}),H&&(0,s.jsx)(d.Fc,{className:"mb-4 border-green-200 bg-green-50",children:(0,s.jsx)(d.TN,{className:"text-green-800",children:H})}),(0,s.jsx)(S.r0,{dataType:"evaluation cards data",children:(0,s.jsx)(E,{evaluationStatus:p,startData:y,endData:b,startAnswersCount:ee,endAnswersCount:et,startQuestionsCount:ea,endQuestionsCount:es})}),(0,s.jsx)(S.r0,{dataType:"evaluation report data",children:(0,s.jsx)(T,{evaluationStatus:p,localLoading:W,_userName:Q,onDownloadReport:er})})]})})})})},63655:(e,t,a)=>{"use strict";a.d(t,{hO:()=>l,sG:()=>o});var s=a(12115),r=a(47650),n=a(99708),i=a(95155),o=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let a=(0,n.TL)(`Primitive.${t}`),r=s.forwardRef((e,s)=>{let{asChild:r,...n}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,i.jsx)(r?a:t,{...n,ref:s})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function l(e,t){e&&r.flushSync(()=>e.dispatchEvent(t))}},85690:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(19946).A)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]])},91788:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(19946).A)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]])},92657:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(19946).A)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},99502:(e,t,a)=>{Promise.resolve().then(a.bind(a,60002))}},e=>{e.O(0,[6169,2108,699,6671,8892,8441,5964,7358],()=>e(e.s=99502)),_N_E=e.O()}]);